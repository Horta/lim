language: python
cache:
  directories:
  - $HOME/download
matrix:
  include:
  - os: linux
    sudo: false
    dist: trusty
    python: '2.7'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.4'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.5'
  - os: osx
    language: generic
    env: TRAVIS_PYTHON_VERSION=3.5
before_install:
- wget https://raw.githubusercontent.com/Horta/travis-miniconda/master/install.sh
  -O install.sh
- chmod +x install.sh
- travis_retry bash -x ./install.sh
install:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
before_script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- pwd
- find .
- python setup.py test
script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py sdist
- pip install dist/`ls dist | grep -i -E '\.(gz)$' | head -1`
- pushd /
- python -c "import lim; lim.test()"
- popd
notifications:
  email: false
branches:
  only:
  - master
deploy:
  provider: pypi
  user: dhorta
  password:
    secure: hTHSuMzFrfTfbTXFviskRH0DFWvj9B5vpToPwDuSCdwUAXMoQ+baBwnF6NdczFBwCz7tK5/Jq2hB8zkqrkz9Phd1Dzi565KXVoqB5RDqMjPLkLouKpCRoFGguRACaiQKdVLh93+QFWDpbimOnQji+zhPowhqbyQmEgr2TzsIkBMjtBTja1/Py1eD2EYlDiXOUSh4A1TAkFT0IW/37pdNWV54r3CUjDjK5mjPaWUZHOJEFOctDPxy1yv9vDzIQ+u/PgOcXtkRynEWVTweoFeO/qAd7gWqVtUt9gTEy3Uy/wbcXGK3yM47EsBYjqKhlQGHRQXCUzORIRT2yPthCfJh0ug2QA8MIN24SALl75RdQCzCfw/spHHYGcN4A5UUUdqtxRsCYwBy3RaT3kdUV/+V+X2WyAdC0Oaz/oIE0sldSadOTWwaztf7WE4PPXbkOJ02yKRyHgwD0MC5NJCjol/CbJDjojLdTVb7hJdA2Sc5gokWEcPqYMFgnTvigLYcqLOD/z0OJN6uAfp953YtyyXDGTHyGOH9QC9/D4NW05bH8I8Ij/4JjsibK4l+86Vo25lMCRPiJHXAFn7Uwaz7NObsQnejHajGl3sAS9McHmrkxYs32lzUgYjdV3TOD8UM9UvcFVsoOhuzoxkha9iaDQJ294LweYHDDAVHkXbuofhNSFA=
  on:
    distributions: sdist bdist_wheel
    repo: Horta/lim
