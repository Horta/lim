language: python
matrix:
  include:
  - os: linux
    sudo: false
    dist: trusty
    python: '2.7'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.4'
  - os: linux
    sudo: false
    dist: trusty
    python: '3.5'
  - os: osx
    language: generic
    env: TRAVIS_PYTHON_VERSION=3.5
before_install:
- wget https://raw.githubusercontent.com/Horta/travis-miniconda/master/install.sh
  -O install.sh
- chmod +x install.sh
- travis_retry bash -x ./install.sh
install:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
before_script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py test
script:
- export PATH="$HOME/miniconda/bin:$PATH"
- source activate travisci
- python setup.py sdist
- pip install dist/`ls dist | grep -i -E '\.(gz)$' | head -1`
- pushd /
- python -c "import lim; lim.test()"
- popd
notifications:
  email: false
branches:
  only:
  - master
deploy:
  provider: pypi
  user: dhorta
  password:
    secure: GcthRfoJgsaywQBCmLr8lyudOHmPl9aBBWQ52SN+tTmahsfDth5YP2zKVSPy3MWa0Bf9gp4QGH26pPz6udmc2AfjehcQqDpy4ep1pstU/VAHhKAhlsl50ttrKekSHQyAMqev1/YlkgalgooOw+TEmX/KUHFii0CBiXyNUjtEcpDRuPhkXMjUvZwG90WAoyByglqGe65thabJYS18OJi9jHSfPbu2fYJvwCHtglzNZgTKyPyXNbUCJGVPazFXbIqyUtZ03JHLOiNygCLrtuXtjqZ5twJGJnAI4GmTHIcgD3AIaiEVguAs2msMQIWmhg3b2G0bEPfp8CgYxWDq3OSLC/RTixwMjGWJu3pjG2tTpxFjRhVWZ7FwSh/IVE/YFR7qRkuBth9Gf6BCRX0Cb4IzTWdys+OK2DFAL8AlRu3JRp5swQF9lTEQKL/UvUuniBukbqFsL9qcCq+/2iHe+FGq0OELOtfGg7o01hv/9YpGm3v4zb3hsTw0Iof9y0n5y6ycMpVNxrpNcqwmoXqjBx0autHH/zPduyvHRdBSqd/zMybU0ijmtbh3ZuS0bVvW+Ys6fgMgpvvXFsPedkmlUImcjFlqc9p1GkiiAI6nBhkoZLFeSAdyBhjsXo97MH6a8xXTHA6O9gKFn3P1vAtaBEkyq37TwFVt8SPXqG6v9ZMnWlY=
  on:
    distributions: sdist bdist_wheel
    repo: Horta/lim
